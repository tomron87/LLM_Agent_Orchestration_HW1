<div dir="rtl">

# 📘 Product Requirements Document (PRD)

## 1. רקע ומטרת המערכת
מטרת הפרויקט היא לבנות מערכת צ’אט אינטראקטיבית הפועלת מול מודלים מקומיים של בינה מלאכותית (LLMs) באמצעות **Ollama**, הכוללת ממשק משתמש גרפי (Streamlit) ו־API עצמאי (FastAPI).  
המערכת מאפשרת שליחת בקשות למודל לוקאלי, ניהול שיחות, בדיקות תקינות סביבת עבודה, והרצה מקצה לקצה — בדגש על ארכיטקטורה מודולרית, קוד קריא, ויכולת הרחבה עתידית.

המערכת פותחה במסגרת קורס “מבוא ל־AI וכלכלת ה־AI” בהנחיית ד״ר יורם גל, כחלק ממטלת Assignment 1.

---

## 2. מטרות עיקריות
- **הקמת ממשק תקשורת מלא** בין משתמש למודל AI מקומי דרך שרת Ollama.  
- **פיתוח API תקני** באמצעות FastAPI עם בקרות גישה, לוגיקה עסקית וניהול בקשות.  
- **פיתוח ממשק משתמש גרפי (UI)** באמצעות Streamlit, להצגת תקשורת בזמן אמת.  
- **הבטחת ניידות מלאה** (פועל מקומית ללא תלות בהתקנות גלובליות).  
- **הטמעת בדיקות יחידה ואינטגרציה**, בהתאם לסטנדרטים תעשייתיים.  
- **תיעוד מקצועי** בכל שלב (PRD, ארכיטקטורה, התקנה ובדיקות, Prompting).

---

## 3. תכולת המערכת
המערכת כוללת שלושה רכיבי ליבה:

| רכיב | תיאור |
|------|--------|
| **API Backend (FastAPI)** | שרת לניהול בקשות הצ’אט, חיבור למודל Ollama, אימות באמצעות API key. |
| **Ollama Client** | רכיב שירות לניהול התקשורת עם שרת ה־Ollama המקומי, כולל שליחת prompt וקבלת תגובה. |
| **Streamlit UI** | ממשק משתמש גרפי אינטראקטיבי המציג שיחה בזמן אמת בין המשתמש למודל. |

המערכת נבנתה באופן מודולרי כך שכל רכיב ניתן להחלפה או הרחבה (לדוגמה: החלפת מודל, הוספת לוגיקת סוכן, הוספת Plugins עתידיים).

---

## 4. דרישות פונקציונליות

| קטגוריה | דרישה |
|----------|--------|
| **צ׳אט בזמן אמת** | המשתמש מזין טקסט בממשק, המערכת שולחת את הבקשה למודל ומחזירה תשובה בזמן אמת. |
| **ניהול שגיאות וחריגות** | טיפול במצבי תקלה בהתחברות ל־Ollama, הצגת הודעת שגיאה למשתמש. |
| **API מאובטח** | נדרש שימוש במפתח גישה (`APP_API_KEY`) לצורך אימות ובקרת שימוש. |
| **Preflight Check** | סקריפט בדיקה אוטומטי שמוודא שהמערכת ערוכה להרצה (Python, חבילות, Ollama, משתנים). |
| **בדיקות** | בדיקות יחידה ואינטגרציה זמינות בתיקיית `tests/`. |

---

## 5. דרישות לא פונקציונליות
- **ביצועים:** תגובה ראשונית תוך ≤2 שניות במודל מקומי.  
- **אמינות:** המערכת תומכת בריצה חוזרת ללא קריסה או דליפת זיכרון.  
- **אבטחה:** שימוש במפתחות סביבה ולא בשדות קשיחים בקוד.  
- **ניידות:** הפעלה מלאה מכל מחשב עם Ollama מותקן.  
- **נגישות:** ממשק גרפי פשוט וברור, מותאם גם להרצה מקומית ללא CLI.  
- **תחזוקתיות:** קוד קריא, מופרד למודולים, ונתמך ע״י תיעוד מלא.

---

## 6. דרישות מערכת והתקנה
המערכת פועלת בסביבת **Python 3.10+**, עם התקנת **Ollama** מקומית.  
ההתקנה מבוצעת לפי השלבים המפורטים במסמך [Installation_and_Testing.md](Installation_and_Testing.md).

רכיבים נדרשים:
- מערכת הפעלה: macOS / Linux / Windows (עם WSL)
- תלות: `fastapi`, `requests`, `streamlit`, `python-dotenv`, `pydantic`
- חיבור מקומי לשרת Ollama זמין ב־`http://127.0.0.1:11434`

---

## 7. מבנה מערכת וארכיטקטורה
מבנה הפרויקט מתואר בפירוט במסמך [Architecture.md](Architecture.md).

**תרשים כללי:**
```
User → Streamlit UI → FastAPI (Chat Router) → Ollama Client → Ollama Server (Local Model)
```

**מבנה תיקיות עיקרי:**
```
HW1_ai_chat_bot/
├── app/
│   ├── api/routers/chat.py
│   ├── core/config.py
│   ├── services/ollama_client.py
│   ├── services/chat_service.py
│   └── main.py
├── ui/streamlit_app.py
├── tests/
├── scripts/
└── documentation/
├── README.md
├── Makefile
├── .env.example
├── .env
├── requirements.txt
└──  .gitignore
```

---

## 8. בדיקות ו-QA

| סוג | מטרה | מיקום |
|------|--------|--------|
| **Unit Tests** | בדיקות יחידה למרכיבי API, ChatService ו־OllamaClient | `/tests/test_*_api.py`, `/tests/test_ollama_client_unit.py` |
| **Integration Tests** | בדיקות תקשורת אמיתית מול שרת Ollama מקומי | `/tests/test_ollama_models_integration.py` |
| **Preflight Script** | מאמת סביבה (Python, חבילות, Ollama, משתני סביבה) | `/scripts/preflight.py` |

הבדיקות ממומשות באמצעות **pytest**, עם שימוש ב־**marker יחיד**:
- `@pytest.mark.integration` עבור בדיקות אינטגרציה.
- כל טסט שאינו מסומן נחשב לבדיקה מסוג Unit ומורץ בעזרת `pytest -m "not integration"`.

תהליך ההרצה והבדיקות כולו מנוהל דרך **Makefile**, המגדיר זרימה מלאה:
> `preflight → install → ollama → api → ui → tests`

לפירוט מלא של פקודות Makefile, הוראות הרצה וסביבת בדיקות –  
ראו מסמך [**Installation_and_Testing.md**](Installation_and_Testing.md).

בדיקות אלו נועדו להבטיח **אמינות, תקינות ויכולת הרצה מלאה** לפני ההגשה,  
ולהבטיח כי המערכת פועלת באופן עקבי בכל סביבת בדיקה.

---

## 9. הרחבות עתידיות
- תמיכה בריבוי מודלים (למשל: Llama 3, Phi 3, Mistral).
- הוספת **Agent Logic** – סוכן פנימי עם ניהול הקשר ושמירת זיכרון ארוך-טווח.
- תמיכה בהיסטוריית שיחות ושמירת Session.
- חיבור למסד נתונים וקטורי (Vector DB) לשם שליפה קונטקסטואלית.
- שילוב Speech-to-Text / Text-to-Speech.
- ממשק ניהול משתמשים.

---

## 10. סיכום
מסמך זה מגדיר את כלל הדרישות והמפרט לפרויקט הצ’אט המקומי מבוסס Ollama.  
המערכת פותחה בהתאם לדרישות הקורס והנחיות ההגשה (GitHub ציבורי, README מלא, בדיקות יחידה ותיעוד).  
להעמקה טכנית, יש לעיין במסמכים הנלווים:
- 📘 **[Architecture.md](Architecture.md)** – פירוט מבנה, זרימת מידע ותרשימי מערכת  
- 🧪 **[Installation_and_Testing.md](Installation_and_Testing.md)** – הוראות התקנה, הרצה ובדיקות  
- 🤖 **[Prompting_and_Developing.md](Prompting_and_Developing.md)** – תיעוד תהליך הפיתוח בעזרת AI  
- 🖼️ **[Screenshots_and_Demonstrations.md](Screenshots_and_Demonstrations.md)** – תיעוד המערכת בפעולה כולל צילומי מסך

</div>
